{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "53299d33_49e6c19c",
        "filename": "core/config.mk",
        "patchSetId": 1
      },
      "lineNbr": 554,
      "author": {
        "id": 1884045
      },
      "writtenOn": "2023-05-30T09:39:09Z",
      "side": 1,
      "message": "We don\u0027t expect to dexpreopt anything for unbundled builds. Dexpreopt only makes sense for bundled builds because the outputs depend on many other things in the system image and can\u0027t be used if any of them has changed.\n\nCould you please explain what BUILDING_WITH_VSDK is and why it expects dexpreopt outputs (`out/dex2oat_result/vendor/app/pasrservice/oat/arm64/package.vdex`)? If it\u0027s only for Qualcomm, could you please limit this change to Qualcomm\u0027s own source tree?",
      "range": {
        "startLine": 552,
        "startChar": 0,
        "endLine": 554,
        "endChar": 7
      },
      "revId": "f53dbb740f69277f6a236ea2ff0efd547b620a14",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "62637c6c_c1404b0e",
        "filename": "core/config.mk",
        "patchSetId": 1
      },
      "lineNbr": 554,
      "author": {
        "id": 1830881
      },
      "writtenOn": "2023-05-30T15:35:04Z",
      "side": 1,
      "message": "BUILDING_WITH_VSDK provides the ability to build the vendor image against a set of system prebuilts provided by VSDK.  The BUILDING_WITH_VSDK based build utilizes the TARGET_BUILD_UNBUNDLED_IMAGE.  \n\nIn this configuration the dexpreopt is run as part of the merge step of the build (merge_target_files.py).\n\nThis change is required to fix the broken VSDK based builds.",
      "parentUuid": "53299d33_49e6c19c",
      "range": {
        "startLine": 552,
        "startChar": 0,
        "endLine": 554,
        "endChar": 7
      },
      "revId": "f53dbb740f69277f6a236ea2ff0efd547b620a14",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "312f591b_8488f854",
        "filename": "core/config.mk",
        "patchSetId": 1
      },
      "lineNbr": 554,
      "author": {
        "id": 1884045
      },
      "writtenOn": "2023-05-30T17:13:52Z",
      "side": 1,
      "message": "OK, thank you for pointing me to the script. Looks like the logic around dexpreopt was introduced by aosp/1774125. I don\u0027t fully understand what the script is doing, so I\u0027m unable to determine whether it\u0027s doing the right thing or not. You are on your own to make sure it\u0027s working properly.\n\nAnyway, please put the explanation as a comment for future reference.\n\nAlso, please note that our future changes will break you. For example, we just submitted aosp/2594905, which added a new required flag `--product_packages` to `dexpreopt_gen`.",
      "parentUuid": "62637c6c_c1404b0e",
      "range": {
        "startLine": 552,
        "startChar": 0,
        "endLine": 554,
        "endChar": 7
      },
      "revId": "f53dbb740f69277f6a236ea2ff0efd547b620a14",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cb5ea795_ef1f7596",
        "filename": "core/config.mk",
        "patchSetId": 1
      },
      "lineNbr": 554,
      "author": {
        "id": 1380269
      },
      "writtenOn": "2023-06-01T16:39:25Z",
      "side": 1,
      "message": "The reason why we apply dexpreopt during the merge step when building with VSDK is to provide the same boot performance as with a regular build. If dexpreopt is not applied during the build, the first boot will take longer, since it has to apply dexpreopt at runtime.",
      "parentUuid": "312f591b_8488f854",
      "range": {
        "startLine": 552,
        "startChar": 0,
        "endLine": 554,
        "endChar": 7
      },
      "revId": "f53dbb740f69277f6a236ea2ff0efd547b620a14",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "892400c0_19326d07",
        "filename": "core/config.mk",
        "patchSetId": 1
      },
      "lineNbr": 554,
      "author": {
        "id": 1884045
      },
      "writtenOn": "2023-06-01T16:55:17Z",
      "side": 1,
      "message": "Acknowledged",
      "parentUuid": "cb5ea795_ef1f7596",
      "range": {
        "startLine": 552,
        "startChar": 0,
        "endLine": 554,
        "endChar": 7
      },
      "revId": "f53dbb740f69277f6a236ea2ff0efd547b620a14",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}