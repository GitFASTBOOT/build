{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "ac4bb957_f36d209d",
        "filename": "core/sysprop.mk",
        "patchSetId": 1
      },
      "lineNbr": 241,
      "author": {
        "id": 1074628
      },
      "writtenOn": "2020-12-08T09:54:02Z",
      "side": 1,
      "message": "These are intentionally not added as dependencies, as we don\u0027t want to force rebuilds when these values change, they should only be picked up when this regenerates.",
      "revId": "384691474978c9419ab74632747c55a5b97e3520",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1bd5e1ad_f307a861",
        "filename": "core/sysprop.mk",
        "patchSetId": 1
      },
      "lineNbr": 241,
      "author": {
        "id": 1514900
      },
      "writtenOn": "2020-12-08T09:59:02Z",
      "side": 1,
      "message": "Maybe mark these as order-only inputs? Can it be done through Kati?",
      "parentUuid": "ac4bb957_f36d209d",
      "revId": "384691474978c9419ab74632747c55a5b97e3520",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "59b58480_2da0cc2b",
        "filename": "core/sysprop.mk",
        "patchSetId": 1
      },
      "lineNbr": 241,
      "author": {
        "id": 1726181
      },
      "writtenOn": "2020-12-08T09:59:55Z",
      "side": 1,
      "message": "Dependencies need to be explicit for Bazel builds to work. Open to other suggestions but builds will fail without these being listed as explicit dependencies somewhere e.g.\n\ncat: out/soong/build_number.txt: No such file or directory\ncat: out/soong/build_number.txt: No such file or directory\ncat: out/build_date.txt: No such file or directory\ncat: out/soong/build_number.txt: No such file or directory\ndate: bad date @\ndate: bad date @",
      "parentUuid": "ac4bb957_f36d209d",
      "revId": "384691474978c9419ab74632747c55a5b97e3520",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "02447eaf_a1eabf86",
        "filename": "core/sysprop.mk",
        "patchSetId": 1
      },
      "lineNbr": 241,
      "author": {
        "id": 1514900
      },
      "writtenOn": "2020-12-08T10:02:50Z",
      "side": 1,
      "message": "Looks like the syntax is\n\n  TARGET: INPUTS | ORDER_ONLY_INPUTS\n\nhttps://www.gnu.org/software/make/manual/html_node/Prerequisite-Types.html\n\nbut doesn\u0027t look like Kati supports them.",
      "parentUuid": "1bd5e1ad_f307a861",
      "revId": "384691474978c9419ab74632747c55a5b97e3520",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c8d5e2d7_0426f73e",
        "filename": "core/sysprop.mk",
        "patchSetId": 1
      },
      "lineNbr": 241,
      "author": {
        "id": 1074628
      },
      "writtenOn": "2020-12-08T10:12:04Z",
      "side": 1,
      "message": "Most of our build rules have non-explicit dependencies (depfiles...), but those tend to be source files. Files that are created from other rules usually have dependencies listed explicitly, but not always (C++ linking: the dependency is on .toc file, but the linker uses the .so file).\n\nout/build_date.txt and out/soong/build_number.txt are considered source files in the android build, it\u0027s bazel that thinks they aren\u0027t. There are a bunch of uses of them throughout the tree:\n\n  https://cs.android.com/search?q\u003dlang:go%20buildNumberFile\u0026ss\u003dandroid%2Fplatform%2Fsuperproject\n  https://cs.android.com/search?q\u003dlang:makefile%20BUILD_NUMBER_FROM_FILE\u0026sq\u003d\u0026ss\u003dandroid%2Fplatform%2Fsuperproject\n\nI think order-only should work (make uses `rule: dep dep | orderonlydep orderonlydep`, and kati definitely supports them), it looks like we\u0027re doing that for droiddoc in Soong already, but there\u0027s quite a few places that\u0027ll need changes, in addition to posting it as a change for downstream users to look at their trees for.",
      "parentUuid": "59b58480_2da0cc2b",
      "revId": "384691474978c9419ab74632747c55a5b97e3520",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "510194b9_6b3a90e6",
        "filename": "core/sysprop.mk",
        "patchSetId": 1
      },
      "lineNbr": 241,
      "author": {
        "id": 1726181
      },
      "writtenOn": "2020-12-08T10:30:38Z",
      "side": 1,
      "message": "Thanks. So just add a pipe like this? (I am running a test build now...)\n\nAlso, fixing this one is enough for USE_BAZEL\u003d1 m dist builds to work, so I think we can worry about the other spots with missing prerequisites later.",
      "parentUuid": "c8d5e2d7_0426f73e",
      "revId": "384691474978c9419ab74632747c55a5b97e3520",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}