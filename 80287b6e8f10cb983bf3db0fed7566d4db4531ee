{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "9d0a8ab8_f20cccfb",
        "filename": "target/product/gsi_release.mk",
        "patchSetId": 2
      },
      "lineNbr": 91,
      "author": {
        "id": 1128729
      },
      "writtenOn": "2023-04-18T03:32:15Z",
      "side": 1,
      "message": "Please remove.",
      "range": {
        "startLine": 91,
        "startChar": 46,
        "endLine": 91,
        "endChar": 47
      },
      "revId": "80287b6e8f10cb983bf3db0fed7566d4db4531ee",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "24a614d0_ed892f21",
        "filename": "target/product/gsi_release.mk",
        "patchSetId": 2
      },
      "lineNbr": 91,
      "author": {
        "id": 1451833
      },
      "writtenOn": "2023-04-18T06:02:48Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9d0a8ab8_f20cccfb",
      "range": {
        "startLine": 91,
        "startChar": 46,
        "endLine": 91,
        "endChar": 47
      },
      "revId": "80287b6e8f10cb983bf3db0fed7566d4db4531ee",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d42fc117_4a1b4c7a",
        "filename": "target/product/gsi_release.mk",
        "patchSetId": 2
      },
      "lineNbr": 95,
      "author": {
        "id": 1128729
      },
      "writtenOn": "2023-04-18T03:32:15Z",
      "side": 1,
      "message": "I thought you want to code\n\n```\nifeq (,$(MODULE_BUILD_FROM_SOURCE))\n^^^^\n    MODULE_BUILD_FROM_SOURCE :\u003d true\nendif\n```\n\nor just:\n\n```\nMODULE_BUILD_FROM_SOURCE ?\u003d true\n```",
      "range": {
        "startLine": 93,
        "startChar": 0,
        "endLine": 95,
        "endChar": 5
      },
      "revId": "80287b6e8f10cb983bf3db0fed7566d4db4531ee",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "31563a87_a551f013",
        "filename": "target/product/gsi_release.mk",
        "patchSetId": 2
      },
      "lineNbr": 95,
      "author": {
        "id": 1451833
      },
      "writtenOn": "2023-04-18T06:02:31Z",
      "side": 1,
      "message": "similar to https://cs.android.com/android/platform/superproject/+/master:build/make/core/android_soong_config_vars.mk;l\u003d75\n\nMODULE_BUILD_FROM_SOURCE ?\u003d true does not seem to work because ?\u003d is a lazy evaluation\n\nifeq (,$(MODULE_BUILD_FROM_SOURCE)) seems to force set the module to true even if it has been lazy set to false previously\n\nGiven all the different options to set it, ifneq (,$(MODULE_BUILD_FROM_SOURCE)) seems to be the most \u0027reliable\u0027",
      "parentUuid": "d42fc117_4a1b4c7a",
      "range": {
        "startLine": 93,
        "startChar": 0,
        "endLine": 95,
        "endChar": 5
      },
      "revId": "80287b6e8f10cb983bf3db0fed7566d4db4531ee",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e437bd0d_4139411e",
        "filename": "target/product/gsi_release.mk",
        "patchSetId": 2
      },
      "lineNbr": 95,
      "author": {
        "id": 1128729
      },
      "writtenOn": "2023-04-18T06:13:28Z",
      "side": 1,
      "message": "`ifneq (,$(MODULE_BUILD_FROM_SOURCE))` means `MODULE_BUILD_FROM_SOURCE` is \"not\" empty, but the comment here is \"only if the MODULE_BUILD_FROM_SOURCE config has not been set\" (`MODULE_BUILD_FROM_SOURCE` \"is\" empty).\n\nAm I confused?\n\nOr, like the reference you want this?\n\n```\nifneq (,$(MODULE_BUILD_FROM_SOURCE))\n    # Keep an explicit setting.\nelse\n^^^^\n    MODULE_BUILD_FROM_SOURCE :\u003d true\nendif\n```",
      "parentUuid": "31563a87_a551f013",
      "range": {
        "startLine": 93,
        "startChar": 0,
        "endLine": 95,
        "endChar": 5
      },
      "revId": "80287b6e8f10cb983bf3db0fed7566d4db4531ee",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "327dabfb_b7197f54",
        "filename": "target/product/gsi_release.mk",
        "patchSetId": 2
      },
      "lineNbr": 95,
      "author": {
        "id": 1451833
      },
      "writtenOn": "2023-04-18T17:23:55Z",
      "side": 1,
      "message": "Hmmm I\u0027ve been spending some time looking into this and you\u0027re right the correct approach is to use ifeq ($(MODULE_BUILD_FROM_SOURCE),), however the issue is that in some of the partner mainline configs, we use MODULE_BUILD_FROM_SOURCE ?\u003d false and essentially all this is leading to lazy evaluation of the config. Long story short, with all the lazy evaluation, MODULE_BUILD_FROM_SOURCE always ends up being true which is what I am trying to avoid.\n\nI do feel that may be the better approach as the generic GSI release config should not really decide if modules should be built from source or not.\n\nI have instead been testing removing this line completely and instead relying on the logic in to decide if the modules need to be built from source or not https://cs.android.com/android/platform/superproject/+/master:build/make/core/android_soong_config_vars.mk;l\u003d75\n\nI have checked this against the GSI target as well as some other internal targets that use gsi_release.mk to see if this works and so far it seems to be doing the right thing. Do you have any concerns if I remove `MODULE_BUILD_FROM_SOURCE :\u003d true` from here completely?",
      "parentUuid": "e437bd0d_4139411e",
      "range": {
        "startLine": 93,
        "startChar": 0,
        "endLine": 95,
        "endChar": 5
      },
      "revId": "80287b6e8f10cb983bf3db0fed7566d4db4531ee",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}