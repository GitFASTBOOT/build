{
  "comments": [
    {
      "key": {
        "uuid": "bf23161e_6d7c55d4",
        "filename": "core/dex_preopt_odex_install.mk",
        "patchSetId": 1
      },
      "lineNbr": 284,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2018-03-20T18:05:47Z",
      "side": 1,
      "message": "Could consider wrapping all of this (and below) into a\n\n ifeq(,$(filter --no-generate-minidebug-info,$(LOCAL_DEXPREOPT_FLAGS)))",
      "range": {
        "startLine": 282,
        "startChar": 0,
        "endLine": 284,
        "endChar": 54
      },
      "revId": "fef156d5e81d9baa51a73eb88e7c856a3b5a5018",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5a46a933_dba068c0",
        "filename": "core/dex_preopt_odex_install.mk",
        "patchSetId": 1
      },
      "lineNbr": 285,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2018-03-22T21:50:30Z",
      "side": 1,
      "message": "Should this be an else? Otherwise you can be passing twice the flag, or worse passing both the --generate and --no-generate?",
      "range": {
        "startLine": 285,
        "startChar": 0,
        "endLine": 285,
        "endChar": 5
      },
      "revId": "fef156d5e81d9baa51a73eb88e7c856a3b5a5018",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "31b71ba8_5d6e7d39",
        "filename": "core/dex_preopt_odex_install.mk",
        "patchSetId": 1
      },
      "lineNbr": 285,
      "author": {
        "id": 1065473
      },
      "writtenOn": "2018-03-22T22:09:14Z",
      "side": 1,
      "message": "I think \"else\" would change behavior if the PRODUCT flags are supposed to override the DEBUG_INFO.  Assuming later flags overwrite the value, I think it is correct as is.\n\nHaving said that, it should be possible to avoid the double flags.\n\nMaybe something like:\nmy_dexpreopt_debug_info :\u003d $(WITH_DEXPREOPT_DEBUG_INFO)\nifneq (false,$(WITH_DEXPREOPT_DEBUG_INFO))\n  # If not set, default to true\n  my_dexpreopt_debug_info :\u003d true\nendif\n\nmy_system_server_debug_info :\u003d $(PRODUCT_SYSTEM_SERVER_DEBUG_INFO)\nifneq (false,$my_system_server_debug_info)\n  # If not set, default to my_dexpreopt_debug_info\n  my_system_server_debug_info :\u003d my_dexpreopt_debug_info\nendif\n\n...",
      "parentUuid": "5a46a933_dba068c0",
      "range": {
        "startLine": 285,
        "startChar": 0,
        "endLine": 285,
        "endChar": 5
      },
      "revId": "fef156d5e81d9baa51a73eb88e7c856a3b5a5018",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "cfe6dbe5_e6b226d3",
        "filename": "core/dex_preopt_odex_install.mk",
        "patchSetId": 1
      },
      "lineNbr": 285,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2018-03-22T22:42:27Z",
      "side": 1,
      "message": "Yeah, the \"later overwrites earlier\" was the intent here, to avoid chaining with a Makefile flag.\n\nIf I wanted the flag, I would not copy it into my_system_server_debug_info, honestly, but use my_dexpreopt_debug_info (and remove \"unknown \u003d depend on dex2oat defaults\" state).\n\n  my_..._info :\u003d true\n  ifeq (false,$(WITH...))\n    my_..._info :\u003d true\n  endif\n\n  if (is-system-server-jar)\n    ifeq (true,$(PRODUCT_SYSTEM_SERVER...INFO))\n      my_..._info :\u003d true\n    else\n  else\n  endif\n\n  if (is-eng)\n    my_..._info :\u003d false\n  endif \n\n  ifeq (true,my_..._info)\n    LOCAL_DEX_PREOPT_FLAGS +\u003d \"--generate...\"\n  else\n    LOCAL_DEX_PREOPT_FLAGS +\u003d \"--no-generate...\"\n  endif\n\nOpinions?",
      "parentUuid": "31b71ba8_5d6e7d39",
      "range": {
        "startLine": 285,
        "startChar": 0,
        "endLine": 285,
        "endChar": 5
      },
      "revId": "fef156d5e81d9baa51a73eb88e7c856a3b5a5018",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "39683775_7bdeb293",
        "filename": "core/dex_preopt_odex_install.mk",
        "patchSetId": 1
      },
      "lineNbr": 285,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2018-03-22T22:47:11Z",
      "side": 1,
      "message": "Or maybe handle it more like WITH_DEXPREOPT, having the WITH be global and final.\n\n  my_..._info :\u003d true\n\n  if (is-system-server-jar)\n    ifeq (false,$(PRODUCT_SYSTEM_SERVER...))\n      my_..._info :\u003d false\n    endif\n  else\n    ...\n  endif\n\n  ifeq (false,$(WITH_..._INFO))\n    my_..._info :\u003d false\n  endif\n\n  ifeq (true,my_..._info)\n    LOCAL_DEX_PREOPT_FLAGS +\u003d \"--generate...\"\n  else\n    LOCAL_DEX_PREOPT_FLAGS +\u003d \"--no-generate...\"\n  endif",
      "parentUuid": "cfe6dbe5_e6b226d3",
      "range": {
        "startLine": 285,
        "startChar": 0,
        "endLine": 285,
        "endChar": 5
      },
      "revId": "fef156d5e81d9baa51a73eb88e7c856a3b5a5018",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "409f6bff_99c06053",
        "filename": "core/dex_preopt_odex_install.mk",
        "patchSetId": 1
      },
      "lineNbr": 285,
      "author": {
        "id": 1065473
      },
      "writtenOn": "2018-03-22T22:58:21Z",
      "side": 1,
      "message": "With the second snippet WITH_DEXPREOPT\u003dfalse takes precedence over everything.",
      "parentUuid": "39683775_7bdeb293",
      "range": {
        "startLine": 285,
        "startChar": 0,
        "endLine": 285,
        "endChar": 5
      },
      "revId": "fef156d5e81d9baa51a73eb88e7c856a3b5a5018",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3a36295b_f722dc2c",
        "filename": "core/dex_preopt_odex_install.mk",
        "patchSetId": 1
      },
      "lineNbr": 285,
      "author": {
        "id": 1065473
      },
      "writtenOn": "2018-03-22T22:58:21Z",
      "side": 1,
      "message": "I don\u0027t think the first snippet works:\nWITH_DEXPREOPT\u003dtrue \u0026\u0026 PRODUCT_SYSTEM_SERVER\u003dfalse still results in SYSTEM_SERVER being on.",
      "parentUuid": "cfe6dbe5_e6b226d3",
      "range": {
        "startLine": 285,
        "startChar": 0,
        "endLine": 285,
        "endChar": 5
      },
      "revId": "fef156d5e81d9baa51a73eb88e7c856a3b5a5018",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "90c6f7c6_27597832",
        "filename": "core/dex_preopt_odex_install.mk",
        "patchSetId": 1
      },
      "lineNbr": 292,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2018-03-22T21:50:30Z",
      "side": 1,
      "message": "Why?",
      "range": {
        "startLine": 292,
        "startChar": 0,
        "endLine": 292,
        "endChar": 22
      },
      "revId": "fef156d5e81d9baa51a73eb88e7c856a3b5a5018",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e687e2a_d2e64753",
        "filename": "core/dex_preopt_odex_install.mk",
        "patchSetId": 1
      },
      "lineNbr": 292,
      "author": {
        "id": 1065473
      },
      "writtenOn": "2018-03-22T21:58:22Z",
      "side": 1,
      "message": "So the old was \"if unspecified, default to true for non-eng\".\nBut the new is \"always disable on non-eng no matter what\".\nIs that right and intentional?  I don\u0027t speak .mk very well.",
      "parentUuid": "90c6f7c6_27597832",
      "range": {
        "startLine": 292,
        "startChar": 0,
        "endLine": 292,
        "endChar": 22
      },
      "revId": "fef156d5e81d9baa51a73eb88e7c856a3b5a5018",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2533d494_5b34c767",
        "filename": "core/dex_preopt_odex_install.mk",
        "patchSetId": 1
      },
      "lineNbr": 292,
      "author": {
        "id": 1065473
      },
      "writtenOn": "2018-03-22T22:09:14Z",
      "side": 1,
      "message": "* Sorry, obviously meant \"always disable on eng\".",
      "parentUuid": "8e687e2a_d2e64753",
      "range": {
        "startLine": 292,
        "startChar": 0,
        "endLine": 292,
        "endChar": 22
      },
      "revId": "fef156d5e81d9baa51a73eb88e7c856a3b5a5018",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9148c8cc_7b87de12",
        "filename": "core/dex_preopt_odex_install.mk",
        "patchSetId": 1
      },
      "lineNbr": 292,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2018-03-22T22:42:27Z",
      "side": 1,
      "message": "This is equivalent (unless we change dex2oat defaults). So this makes things more explicit with the \"let\u0027s default to true.\" We can reconsider adding minidebuginfo to the boot image in eng in a follow-up.",
      "parentUuid": "2533d494_5b34c767",
      "range": {
        "startLine": 292,
        "startChar": 0,
        "endLine": 292,
        "endChar": 22
      },
      "revId": "fef156d5e81d9baa51a73eb88e7c856a3b5a5018",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "36cbb473_b5bb2c6e",
        "filename": "core/dex_preopt_odex_install.mk",
        "patchSetId": 1
      },
      "lineNbr": 292,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2018-03-22T22:44:32Z",
      "side": 1,
      "message": "Why did we not enable it on eng before?",
      "parentUuid": "9148c8cc_7b87de12",
      "range": {
        "startLine": 292,
        "startChar": 0,
        "endLine": 292,
        "endChar": 22
      },
      "revId": "fef156d5e81d9baa51a73eb88e7c856a3b5a5018",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "efea9074_6b533244",
        "filename": "core/dex_preopt_odex_install.mk",
        "patchSetId": 1
      },
      "lineNbr": 292,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2018-03-22T22:47:11Z",
      "side": 1,
      "message": "Don\u0027t remember. Possibly compile-time implications.",
      "parentUuid": "36cbb473_b5bb2c6e",
      "range": {
        "startLine": 292,
        "startChar": 0,
        "endLine": 292,
        "endChar": 22
      },
      "revId": "fef156d5e81d9baa51a73eb88e7c856a3b5a5018",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "86c40d82_3a5c8027",
        "filename": "core/dex_preopt_odex_install.mk",
        "patchSetId": 1
      },
      "lineNbr": 292,
      "author": {
        "id": 1065473
      },
      "writtenOn": "2018-03-22T22:58:21Z",
      "side": 1,
      "message": "Did we disable it in eng though?\nWith PRODUCT_SYSTEM_SERVER_DEBUG_INFO\u003dtrue, the old code would honor it.  The new code just disables end no matter what the config is.",
      "parentUuid": "efea9074_6b533244",
      "range": {
        "startLine": 292,
        "startChar": 0,
        "endLine": 292,
        "endChar": 22
      },
      "revId": "fef156d5e81d9baa51a73eb88e7c856a3b5a5018",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}