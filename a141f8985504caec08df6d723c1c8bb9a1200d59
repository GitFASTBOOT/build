{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "c3256c3f_dacc90e1",
        "filename": "ci/Android.bp",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1480888
      },
      "writtenOn": "2024-05-09T22:32:45Z",
      "side": 1,
      "message": "Please fix this WARNING reported by Android Ownership Lint: Ownership attribution is recommended for test targets. Target \u0027build_test_suites_local_test\u0027 is missing an owner. Please refer to the ownership guidelines doc go/new-android-ownership-model for more information.\n\nAnalyzer Description: Validates test targets attribution.\nOwner: crumpet-eng@google.com\n\nOwnership attribution is recommended for test targets. Target \u0027build_test_suites_local_test\u0027 is missing an owner. Please refer to the ownership guidelines doc go/new-android-ownership-model for more information.",
      "range": {
        "startLine": 0,
        "startChar": 0,
        "endLine": 0,
        "endChar": 0
      },
      "revId": "a141f8985504caec08df6d723c1c8bb9a1200d59",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d3a9c68a_03e96ea7",
        "filename": "ci/Android.bp",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1900272
      },
      "writtenOn": "2024-05-09T23:43:04Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c3256c3f_dacc90e1",
      "range": {
        "startLine": 0,
        "startChar": 0,
        "endLine": 0,
        "endChar": 0
      },
      "revId": "a141f8985504caec08df6d723c1c8bb9a1200d59",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1c6cc7e7_930efcd2",
        "filename": "ci/protos/buildcontext.proto",
        "patchSetId": 1
      },
      "lineNbr": 23,
      "author": {
        "id": 1480888
      },
      "writtenOn": "2024-05-09T22:32:45Z",
      "side": 1,
      "message": "I believe we discussed:\n\n1) Smaller scope of experiment.\n2) Putting this in build features vs hard-coding the name.\n\nYour call.",
      "range": {
        "startLine": 23,
        "startChar": 16,
        "endLine": 23,
        "endChar": 39
      },
      "fixSuggestions": [
        {
          "fixId": "4d1d50a6_4ef79297",
          "description": "prompt_to_edit API",
          "replacements": [
            {
              "path": "ci/protos/buildcontext.proto",
              "range": {
                "startLine": 22,
                "startChar": 0,
                "endLine": 24,
                "endChar": 0
              },
              "replacement": "  // Whether to enable the feature.\n  optional bool feature_enabled \u003d 1;\n"
            }
          ]
        }
      ],
      "revId": "a141f8985504caec08df6d723c1c8bb9a1200d59",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "160726dd_d390eca6",
        "filename": "ci/protos/buildcontext.proto",
        "patchSetId": 1
      },
      "lineNbr": 23,
      "author": {
        "id": 1076194
      },
      "writtenOn": "2024-05-10T02:51:03Z",
      "side": 1,
      "message": "1) What\u0027s your thinking here?\n\n2) Personally I\u0027m a fan of simple bool fields rather than repeated KeyValue fields. This is taking advantage of the structure of proto to provide documentation and validation for the interface.",
      "parentUuid": "1c6cc7e7_930efcd2",
      "range": {
        "startLine": 23,
        "startChar": 16,
        "endLine": 23,
        "endChar": 39
      },
      "revId": "a141f8985504caec08df6d723c1c8bb9a1200d59",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4dc6c988_37f0336a",
        "filename": "ci/protos/buildcontext.proto",
        "patchSetId": 1
      },
      "lineNbr": 23,
      "author": {
        "id": 1900272
      },
      "writtenOn": "2024-05-10T21:55:40Z",
      "side": 1,
      "message": "I think Hadrien is talking about not enabling/disabling BWYN as a whole, but narrowing it down to smaller features. For example if the first step in doing BWYN is just not building mts in presubmit, we should probably roll that out specifically not just fully disable BWYN. I think that\u0027s also where #2 comes in where if we have to add a field for every little feature it\u0027s gonna start getting cluttered quickly. I\u0027m not exactly sure what the best solution is, I think having a list of feature-name/enabled pairs makes sense if we\u0027re gonna get very granular, but I see what David is talking about.",
      "parentUuid": "160726dd_d390eca6",
      "range": {
        "startLine": 23,
        "startChar": 16,
        "endLine": 23,
        "endChar": 39
      },
      "revId": "a141f8985504caec08df6d723c1c8bb9a1200d59",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2bf9c6da_0d31637e",
        "filename": "ci/protos/buildcontext.proto",
        "patchSetId": 1
      },
      "lineNbr": 26,
      "author": {
        "id": 1480888
      },
      "writtenOn": "2024-05-09T22:32:45Z",
      "side": 1,
      "message": "Why are you introducing this if you\u0027re not doing anything with it yet? It\u0027s likely to chagne.\n\nConsider a `TestContext` object. Also passing in the test groups means that TH will need to parse and extract the information out of the ATP Test Plan. That means that any change will require modifications in the proto, TH, and build script.\n\nWhy not just forward the proto (as a field or opaque text) for the build script to interpret any way it wants to?",
      "range": {
        "startLine": 26,
        "startChar": 18,
        "endLine": 26,
        "endChar": 42
      },
      "fixSuggestions": [
        {
          "fixId": "76523039_d15f36a2",
          "description": "prompt_to_edit API",
          "replacements": [
            {
              "path": "ci/protos/buildcontext.proto",
              "range": {
                "startLine": 24,
                "startChar": 0,
                "endLine": 27,
                "endChar": 0
              },
              "replacement": ""
            }
          ]
        }
      ],
      "revId": "a141f8985504caec08df6d723c1c8bb9a1200d59",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ea5098fd_a267d63b",
        "filename": "ci/protos/buildcontext.proto",
        "patchSetId": 1
      },
      "lineNbr": 26,
      "author": {
        "id": 1076194
      },
      "writtenOn": "2024-05-10T02:51:03Z",
      "side": 1,
      "message": "The worknode proto is a Google-internal proto so we can\u0027t use it here. We don\u0027t generally want to be arbitrarily forwarding data from it out -- it\u0027s better to parse it down to what is really needed first before passing it to Android code.\n\nWe use blob fields for WorkPlan so we can update the proto without waiting for a schema update.",
      "parentUuid": "2bf9c6da_0d31637e",
      "range": {
        "startLine": 26,
        "startChar": 18,
        "endLine": 26,
        "endChar": 42
      },
      "revId": "a141f8985504caec08df6d723c1c8bb9a1200d59",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "01fda394_dd86ed7e",
        "filename": "ci/protos/buildcontext.proto",
        "patchSetId": 1
      },
      "lineNbr": 26,
      "author": {
        "id": 1480888
      },
      "writtenOn": "2024-05-10T17:27:45Z",
      "side": 1,
      "message": "Could you elaborate on what you mean by the \u0027blob fields\u0027 comment? Isn\u0027t that just forwarding the data?",
      "parentUuid": "ea5098fd_a267d63b",
      "range": {
        "startLine": 26,
        "startChar": 18,
        "endLine": 26,
        "endChar": 42
      },
      "revId": "a141f8985504caec08df6d723c1c8bb9a1200d59",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "36bb1dee_563a25f7",
        "filename": "ci/protos/buildcontext.proto",
        "patchSetId": 1
      },
      "lineNbr": 26,
      "author": {
        "id": 1076194
      },
      "writtenOn": "2024-05-10T19:27:20Z",
      "side": 1,
      "message": "Back in 2016, whenever you updated the worknode proto, it would require a schema update to spanner which could take weeks to roll out thus blocking changes. For this reason I suggested to Luca including all fields he would need. However, after your comment, I verified this is no longer necessary because worknode proto has been updated to use a blob proto and thus just forwards the underlying proto.\n\nWith that in mind, I\u0027m wondering what your suggestion is. Is your suggestion just to remove test_mapping_groups_used because he isn\u0027t using it yet? If so, that\u0027s fine with me.",
      "parentUuid": "01fda394_dd86ed7e",
      "range": {
        "startLine": 26,
        "startChar": 18,
        "endLine": 26,
        "endChar": 42
      },
      "revId": "a141f8985504caec08df6d723c1c8bb9a1200d59",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b3ad83a5_b9993850",
        "filename": "ci/protos/buildcontext.proto",
        "patchSetId": 1
      },
      "lineNbr": 26,
      "author": {
        "id": 1480888
      },
      "writtenOn": "2024-05-10T23:25:50Z",
      "side": 1,
      "message": "Yeah that makes sense and in the spirit of what I meant. I suggested 2 things:\n\n1) Remove fields we\u0027re not currently using or intend on using as it will most likely change.\n\n2) Avoid having to constantly change both TH and the build script every time we need a field. The options I can think of are: Forward as bytes or include the ATP proto message.\n\nYour call if it\u0027s not possible due to visibility issues. As a last resort consider packaging the information in message types (e.g. `TestPlan`) which will probably grow to contain more information.",
      "parentUuid": "36bb1dee_563a25f7",
      "range": {
        "startLine": 26,
        "startChar": 18,
        "endLine": 26,
        "endChar": 42
      },
      "revId": "a141f8985504caec08df6d723c1c8bb9a1200d59",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "121621ef_7f70331d",
        "filename": "ci/protos/buildcontext.proto",
        "patchSetId": 1
      },
      "lineNbr": 26,
      "author": {
        "id": 1074628
      },
      "writtenOn": "2024-05-10T23:29:49Z",
      "side": 1,
      "message": "\u003e 2) Avoid having to constantly change both TH and the build script every time we need a field. The options I can think of are: Forward as bytes or include the ATP proto message.\n\nExcept that kinda needs to happen, and is why we\u0027re using a data format that includes methods of making compatible changes. TH is going to need to present a config that works with months/years old build script versions in addition to the latest.",
      "parentUuid": "b3ad83a5_b9993850",
      "range": {
        "startLine": 26,
        "startChar": 18,
        "endLine": 26,
        "endChar": 42
      },
      "revId": "a141f8985504caec08df6d723c1c8bb9a1200d59",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5897e30c_bdfb96a3",
        "filename": "ci/protos/buildcontext.proto",
        "patchSetId": 1
      },
      "lineNbr": 26,
      "author": {
        "id": 1480888
      },
      "writtenOn": "2024-05-10T23:35:06Z",
      "side": 1,
      "message": "Yeah, the version skew was my biggest concern. In theory, the ATP proto should be backwards compatible since it\u0027s proto but it may have restricted visibility.\n\nI suggested packaging into a proto that \u0027sort of\u0027 maps to ATP test configs as a last resort to better group the data.",
      "parentUuid": "121621ef_7f70331d",
      "range": {
        "startLine": 26,
        "startChar": 18,
        "endLine": 26,
        "endChar": 42
      },
      "revId": "a141f8985504caec08df6d723c1c8bb9a1200d59",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}