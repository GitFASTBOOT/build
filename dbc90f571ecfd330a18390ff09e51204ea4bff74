{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "c55a478b_c58377d5",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 14,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2021-04-14T13:43:37Z",
      "side": 1,
      "message": "Hmm, this key doesn\u0027t work with libavb.\n\nOn the device, libavb-\u003eavb_slot_verify() will return AVB_SLOT_VERIFY_RESULT_ERROR_PUBLIC_KEY_REJECTED with the following error message:\n\navb_rsa.c:279: ERROR: Padding check failed.\n\nhttps://cs.android.com/android/platform/superproject/+/master:external/avb/libavb/avb_rsa.c;l\u003d278-279;drc\u003d047ecf7d2361ffcb39a5a4ec0709480f47ed76e2\n\nI can also reproduce the failure on host-side tool:\n\n1. add_hash_footer --partition_name boot --partition_size $((96*1024*1024)) --image $OUT/boot.img --algorithm SHA256_RSA2048 --key build/make/target/product/security/testkey.rsa.pem\n\n2. avbtool verify_image --image boot.img\n\nâ‡’ out/soong/host/linux-x86/bin/avbtool: Signature check failed for SHA256_RSA2048 vbmeta struct\n\n\nI\u0027ll probably generate a new key under: build/make/target/product/gsi/testkey_rsa2048.pem.\n\n`openssl genrsa -out testkey_rsa2048.pem 2048` this key can work with libavb.",
      "range": {
        "startLine": 14,
        "startChar": 37,
        "endLine": 14,
        "endChar": 52
      },
      "revId": "dbc90f571ecfd330a18390ff09e51204ea4bff74",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "65403b51_3ea5d8ee",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 14,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2021-04-14T13:45:45Z",
      "side": 1,
      "message": "Correct the typo for the 2nd command:\n\n  avbtool verify_image --image $OUT/boot.img",
      "parentUuid": "c55a478b_c58377d5",
      "range": {
        "startLine": 14,
        "startChar": 37,
        "endLine": 14,
        "endChar": 52
      },
      "revId": "dbc90f571ecfd330a18390ff09e51204ea4bff74",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "81fe4bf7_9eda4ed7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2021-04-14T13:43:37Z",
      "side": 1,
      "message": "cc: David to see if any thoughts about why \"build/make/target/product/security/testkey.rsa.pem\" doesn\u0027t work with libavb.\n\nThe key is generated by the existing key: build/make/target/product/security/testkey.pk8:\n  * openssl pkcs8 -inform DER -nocrypt -in testkey.pk8 -out testkey.pem\n  * openssl rsa -in testkey.pem -out testkey.rsa.pem",
      "revId": "dbc90f571ecfd330a18390ff09e51204ea4bff74",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}