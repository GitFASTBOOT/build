{
  "comments": [
    {
      "key": {
        "uuid": "d89ebcf1_568007b4",
        "filename": "core/main.mk",
        "patchSetId": 6
      },
      "lineNbr": 1027,
      "author": {
        "id": 1060959
      },
      "writtenOn": "2019-03-12T16:17:34Z",
      "side": 1,
      "message": "I\u0027m not sure about the change to resolve-shared-libs-deps (hopefully Dan knows more about that), but this change and the one below look like they should be made regardless? Does LOCAL_TARGET_REQUIRED_MODULES actually work as expected right now? Perhaps it\u0027s just \nleading to inaccuracies in product_FILES...?",
      "revId": "155fedfe65b2a9e824f2f722358a3ced2f370bb5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cee9cf9a_18bf226e",
        "filename": "core/main.mk",
        "patchSetId": 6
      },
      "lineNbr": 1027,
      "author": {
        "id": 1047684
      },
      "writtenOn": "2019-03-12T16:44:22Z",
      "side": 1,
      "message": "I think add-all-host-to-target-required-modules-deps adds LOCAL_TARGET_REQUIRED_MODULES by calling add-required-deps. \n\nIIUC, add-all-host-to-target-required-modules-deps has extra logic, e.g. build error if host module added LOCAL_TARGET_REQUIRED_MODULES. So we may need to keep it.",
      "parentUuid": "d89ebcf1_568007b4",
      "revId": "155fedfe65b2a9e824f2f722358a3ced2f370bb5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "723f3596_a401244a",
        "filename": "core/main.mk",
        "patchSetId": 6
      },
      "lineNbr": 1027,
      "author": {
        "id": 1060959
      },
      "writtenOn": "2019-03-12T17:11:44Z",
      "side": 1,
      "message": "\u003e I think add-all-host-to-target-required-modules-deps adds LOCAL_TARGET_REQUIRED_MODULES by calling add-required-deps. \n\nThat makes sense, but I think product_FILES will still be inaccurate.\n\nIt\u0027s also not clear to me how it interacts with OVERRIDES. If I\u0027m reading things correctly, a shared lib will always be included if depended on even if the lib is overridden by another via LOCAL_OVERRIDES_MODULES.\n\n\u003e \n\u003e IIUC, add-all-host-to-target-required-modules-deps has extra logic, e.g. build error if host module added LOCAL_TARGET_REQUIRED_MODULES. So we may need to keep it.",
      "parentUuid": "cee9cf9a_18bf226e",
      "revId": "155fedfe65b2a9e824f2f722358a3ced2f370bb5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "054d7be3_b0fc5f97",
        "filename": "core/main.mk",
        "patchSetId": 6
      },
      "lineNbr": 1027,
      "author": {
        "id": 1047684
      },
      "writtenOn": "2019-03-12T19:56:15Z",
      "side": 1,
      "message": "\u003e It\u0027s also not clear to me how it interacts with OVERRIDES. If I\u0027m reading things correctly, a shared lib will always be included if depended on even if the lib is overridden by another via LOCAL_OVERRIDES_MODULES.\n\nI did not try to understand the OVERRIDES issue. Is it an existing issue before my change? I know a little about make on Android.",
      "parentUuid": "723f3596_a401244a",
      "revId": "155fedfe65b2a9e824f2f722358a3ced2f370bb5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ba2d1ee6_df56c69d",
        "filename": "core/main.mk",
        "patchSetId": 6
      },
      "lineNbr": 1027,
      "author": {
        "id": 1060959
      },
      "writtenOn": "2019-04-02T13:24:14Z",
      "side": 1,
      "message": "Note that the way things work currently (IIUC)\n- LOCAL_TARGET_REQUIRED_MODULES is only to be used from HOST modules\n- LOCAL_HOST_REQUIRED_MODULES is only to be used from TARGET modules\n\nThis CL appears to change that by changing these two expand-required-... macros here, but only sets up the dependencies accordingly for shared libraries, but not other module classes.\n\nFor example, if I made an ETC module X that depended on another module Y via LOCAL_TARGET_REQUIRED_MODULES, I don\u0027t think changing Y would cause X to get rebuilt (but it would if Y was a shared library..). I think at a minimum the macro on line 647 needs to be changed as well.\n\nI think this CL should be split up into two separate changes that:\n1) change the semantics of LOCAL_[TARGET|HOST]_REQUIRED_MODULES, consistently for all module types\n2) changes shared library dependencies to separate between TARGET/HOST deps\n\nThey\u0027d also need to be tested more thoroughly than \"Test: device boot\", as that wouldn\u0027t surface the kind of subtle problems that changes like this one would produce.",
      "parentUuid": "054d7be3_b0fc5f97",
      "revId": "155fedfe65b2a9e824f2f722358a3ced2f370bb5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}