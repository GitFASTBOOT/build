{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "7072d572_76dcc65d",
        "filename": "target/product/generic/Android.bp",
        "patchSetId": 1
      },
      "lineNbr": 410,
      "author": {
        "id": 1878380
      },
      "writtenOn": "2024-12-10T04:18:53Z",
      "side": 1,
      "message": "`com.android.compos` is [system_ext_specific](https://source.corp.google.com/h/googleplex-android/platform/packages/modules/Virtualization/+/1b4f36666c4b2a6204844f298748381438777eff:build/compos/Android.bp;l\u003d41;drc\u003d2528487c1d3007c65b631cb998d408e04d10cac1;bpv\u003d1;bpt\u003d0). IIUC, this CL will install compos in the `system` partition for targets that use the soong generic system image ([Cuttlefish currently](https://source.corp.google.com/search?q\u003dUSE_SOONG_DEFINED_SYSTEM_IMAGE\u0026sq\u003drepo:googleplex-android%2Fplatform%2Fsuperproject%2Fmain%20b:main)).\n\nIs installing compos in `system` intentional? If so, can we remove `system_ext_specific` from its Android.bp?",
      "range": {
        "startLine": 410,
        "startChar": 9,
        "endLine": 410,
        "endChar": 29
      },
      "revId": "225b7a4eb80b843bdac6b74a9a18a4fc07770492",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9ef920db_3cb32db0",
        "filename": "target/product/generic/Android.bp",
        "patchSetId": 1
      },
      "lineNbr": 410,
      "author": {
        "id": 1291338
      },
      "writtenOn": "2024-12-10T04:21:48Z",
      "side": 1,
      "message": "As you can see in the allow list, it\u0027s not the `com.android.compos` but `odex` and `vdex`. Although `com.android.compos` itself is installed to `system_ext/`, `odex` and `vdex` are still in `system/`.\n\nDoes this make sense?",
      "parentUuid": "7072d572_76dcc65d",
      "range": {
        "startLine": 410,
        "startChar": 9,
        "endLine": 410,
        "endChar": 29
      },
      "revId": "225b7a4eb80b843bdac6b74a9a18a4fc07770492",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4aef5b1e_027d611a",
        "filename": "target/product/generic/Android.bp",
        "patchSetId": 1
      },
      "lineNbr": 410,
      "author": {
        "id": 1878380
      },
      "writtenOn": "2024-12-10T04:31:45Z",
      "side": 1,
      "message": "I think this is WAI. I recently moved the odex files of compos out of [system--\u003esystem_ext](https://android-review.git.corp.google.com/q/topic:%22mv_systemext_sscp_dexpreopt%22) and also removed the odex files from the allowlist in `tools/filelistdiff/allowlist` (the allowlist used in trunk_staging).\n\nHowever, I had to flag guard it due to the fact that the accompanying change in art/ is not available in next (next uses ART prebuilts). Once a new set of ART prebuilts is created containg https://android-review.git.corp.google.com/c/platform/art/+/3287191, ART will be able to locate these odex files in system_ext, and it will be safe to install these files in system_ext for `next`\n\n`RELEASE_INSTALL_APEX_SYSTEMSERVER_DEXPREOPT_SAME_PARTITION` is the build flag and b/379743613 is the tracking bug to promote this flag.",
      "parentUuid": "9ef920db_3cb32db0",
      "range": {
        "startLine": 410,
        "startChar": 9,
        "endLine": 410,
        "endChar": 29
      },
      "revId": "225b7a4eb80b843bdac6b74a9a18a4fc07770492",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}