{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "4298eeb3_0fea4a20",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2022-08-31T17:11:03Z",
      "side": 1,
      "message": "Why does bazel need to know about `LOCAL_STATIC_JAVA_LIBRARIES`?  The classes are already in the output jar of the module.\n\n`LOCAL_JAVA_LIBRARIES` is a bigger problem.  Similarly to `required`, there isn\u0027t enough information on meaning of `LOCAL_JAVA_LIBRARIES` for the build to know what to do with them.  Sometimes they are just annotation classes that are only needed at build time.  Sometimes they are references to modules that are already on the bootclasspath and shouldn\u0027t be packaged with the test.  Sometimes they are to make classes from another module available at compile time, but at runtime they will be loaded from some 3rd module that is already available.  And sometimes they really are classes that have to be packaged with the test.\n\nAlso, git commit messages should be wrapped at 70 columns.",
      "revId": "d13f12c8262cb5135b37659b8a6da1d8f75f5aad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b11861f6_e387e161",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 1890551
      },
      "writtenOn": "2022-09-01T04:01:37Z",
      "side": 1,
      "message": "Bazel requires `LOCAL_STATIC_JAVA_LIBRARIES`, because the static dependencies also declare runtime dependencies in `LOCAL_JAVA_LIBRARIES`.\n\nAny suggestion on `LOCAL_JAVA_LIBRARIES`? If we can\u0027t distinguish them, we have to provide them all when setting up testing environment.\n\nThe commit message is formatted automatically. I wonder if you mean that I need manually break the sentences?",
      "parentUuid": "4298eeb3_0fea4a20",
      "revId": "d13f12c8262cb5135b37659b8a6da1d8f75f5aad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a549dc50_346feb3e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 1890551
      },
      "writtenOn": "2022-09-01T07:12:32Z",
      "side": 1,
      "message": "Fixed the commit message. Thanks",
      "parentUuid": "b11861f6_e387e161",
      "revId": "d13f12c8262cb5135b37659b8a6da1d8f75f5aad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "54933d03_430c3c7d",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2022-09-01T15:54:21Z",
      "side": 1,
      "message": "We generally don\u0027t support transitive dependencies of static libraries in Make and Soong, so it would be reasonable (although unfortunate) to require transitive runtime dependencies to be repeated on the top level module.\n\nDo you have a concrete example of the tests that use LOCAL_JAVA_LIBRARIES that you are trying to support?",
      "parentUuid": "a549dc50_346feb3e",
      "revId": "d13f12c8262cb5135b37659b8a6da1d8f75f5aad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d4f9b471_9542e688",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 1890551
      },
      "writtenOn": "2022-09-01T16:28:12Z",
      "side": 1,
      "message": "GtsArtManagerHostTestCases is an example(internal branch), it declares xts-host-util in LOCAL_JAVA_LIBRARIES.",
      "parentUuid": "54933d03_430c3c7d",
      "revId": "d13f12c8262cb5135b37659b8a6da1d8f75f5aad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2a83330b_adebc353",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2022-09-01T17:29:03Z",
      "side": 1,
      "message": "What happens if you don\u0027t propagate that dependency?  I don\u0027t see anything in the AndroidTest.xml file that would make classes from that jar available at runtime, so how is the test working outside of bazel?  Is it because the test infrastructure is putting `out/host/linux-x86/framework/*.jar` in the classpath?\n\nYou can see the problem with `LOCAL_JAVA_LIBRARIES` in that module.  There are lots of dependencies there, including `tradefed`, that are already provided at runtime, and packaging a duplicate copy might cause other problems.\n\nOne option would be moving `xts-host-util` into `LOCAL_STATIC_JAVA_LIBRARIES` so that it is packaged with the test.",
      "parentUuid": "54933d03_430c3c7d",
      "revId": "d13f12c8262cb5135b37659b8a6da1d8f75f5aad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c3f3ea0d_c002b95c",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 1890551
      },
      "writtenOn": "2022-09-02T02:38:11Z",
      "side": 1,
      "message": "`xts-host-util` is required because the `InstallDexMetadataHostTest.java`(src of `GtsArtManagerHostTestCases`) imports `GmsUtil` class that is in `xts-host-util`.\n\nDeclaring every dependencies explicitly including `tradefed` is the the correct thing that Bazel wants users to do. The reason we provide `tradefed` by default is that it\u0027s hard to add `tradefed` for every test module, but we still want users to declare it explicitly.\n\n`GtsArtManagerHostTestCases` and `xts-host-util` is just an example, there are many other tests and dependencies. We can\u0027t distinguish and verify them one by one, since that will block the whole project progress. Otherwise, we need to add all dependencies declared in `LOCAL_JAVA_LIBRARIES` into `LOCAL_STATIC_JAVA_LIBRARIES`, but this will significantly increase the package size. I think it\u0027s not worth. WDYT?",
      "parentUuid": "2a83330b_adebc353",
      "revId": "d13f12c8262cb5135b37659b8a6da1d8f75f5aad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "746747af_00f2b4b5",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2022-09-06T17:29:42Z",
      "side": 1,
      "message": "Adding them all to `LOCAL_STATIC_JAVA_LIBRARIES` won\u0027t be safe either.  I don\u0027t see much option other than handling it on a case-by-case basis, there\u0027s just not enough information in the build files on why any particular library is in `LOCAL_JAVA_LIBRARIES`.",
      "parentUuid": "c3f3ea0d_c002b95c",
      "revId": "d13f12c8262cb5135b37659b8a6da1d8f75f5aad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}