{
  "comments": [
    {
      "key": {
        "uuid": "dbea4b60_4dc6e984",
        "filename": "core/base_rules.mk",
        "patchSetId": 10
      },
      "lineNbr": 653,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2018-08-21T14:47:24Z",
      "side": 1,
      "message": "What is the problem here?\n\nMake sure it\u0027s described in a bug and use TODO(b/####) to make it easier to get more context if it isn\u0027t fixed quickly.",
      "revId": "8c56787d923f07983b0a6de099084b455a60c642",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "03c4642d_629f2776",
        "filename": "core/base_rules.mk",
        "patchSetId": 10
      },
      "lineNbr": 653,
      "author": {
        "id": 1083173
      },
      "writtenOn": "2018-08-22T01:40:31Z",
      "side": 1,
      "message": "Yes what is the parsing problem?\n\nI\u0027d like more details here.",
      "parentUuid": "dbea4b60_4dc6e984",
      "revId": "8c56787d923f07983b0a6de099084b455a60c642",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "80aa7cc6_0b4e03be",
        "filename": "core/base_rules.mk",
        "patchSetId": 10
      },
      "lineNbr": 653,
      "author": {
        "id": 1083173
      },
      "writtenOn": "2018-08-22T01:46:44Z",
      "side": 1,
      "message": "If the problem is that you need to land your atest change at the same time as this change, just set a topic :).",
      "parentUuid": "03c4642d_629f2776",
      "revId": "8c56787d923f07983b0a6de099084b455a60c642",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b00d4899_c31f5979",
        "filename": "core/base_rules.mk",
        "patchSetId": 10
      },
      "lineNbr": 653,
      "author": {
        "id": 1307893
      },
      "writtenOn": "2018-08-22T02:08:36Z",
      "side": 1,
      "message": "Atest will add a new target for it. But this target doesn\u0027t exist.\ne.g. \n  atest hello_world_test\n\nBuilding targets: out/target/product/walleye/module-info.json tradefed-core MODULES-IN-out-soong-.intermediates-platform_testing-tests-example-native-hello_world_test-linux_glibc_x86_64\n\nBut there is no such build target of \"\u0027MODULES-IN-out-soong-.intermediates-platform_testing-tests-example-native-hello_world_test-linux_glibc_x86_64\u0027\"\n\nFAILED: ninja: unknown target \u0027MODULES-IN-out-soong-.intermediates-platform_testing-tests-example-native-hello_world_test-linux_glibc_x86_64\u0027\n10:05:16 ninja failed with: exit status 1\n\nI\u0027ll create a new Bug ID for it later, thanks.",
      "parentUuid": "80aa7cc6_0b4e03be",
      "revId": "8c56787d923f07983b0a6de099084b455a60c642",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "57f5e3e8_a48a7286",
        "filename": "core/base_rules.mk",
        "patchSetId": 10
      },
      "lineNbr": 653,
      "author": {
        "id": 1083173
      },
      "writtenOn": "2018-08-22T02:29:26Z",
      "side": 1,
      "message": "That sounds like a bug in your atest code:\n\n  \"hello_world_test\": { \"class\": [\"NATIVE_TESTS\"],  \"path\": [\"platform_testing/tests/example/native\"],  \"tags\": [\"optional\"],  \"installed\": [\"out/host/linux-x86/nativetest64/hello_world_test/hello_world_test\",  \"out/target/product/generic_arm64/data/nativetest64/hello_world_test/hello_world_test\"],  \"compatibility_suites\": [\"device-tests\"],  \"auto_test_config\": [],  \"module_name\": [\"hello_world_test\"],  \"test_config\": [\"out/soong/.intermediates/platform_testing/tests/example/native/hello_world_test/linux_glibc_x86_64/hello_world_test.config\"] },\n\nI recommend removing this section like Colin suggested and have the corresponding atest fix be in a topic.",
      "parentUuid": "b00d4899_c31f5979",
      "revId": "8c56787d923f07983b0a6de099084b455a60c642",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "59558ac5_bb9a86ea",
        "filename": "core/base_rules.mk",
        "patchSetId": 10
      },
      "lineNbr": 653,
      "author": {
        "id": 1308044
      },
      "writtenOn": "2018-08-22T02:56:37Z",
      "side": 1,
      "message": "I think keeping the original part but update as Colin comment make much more sense.\nthe module info here.\n  \"hello_world_test\": { \"class\": [\"NATIVE_TESTS\"],  \"path\": [\"platform_testing/tests/example/native\"],  \"tags\": [\"optional\"],  \"installed\": [\"out/host/linux-x86/nativetest64/hello_world_test/hello_world_test\",  \"out/target/product/generic_arm64/data/nativetest64/hello_world_test/hello_world_test\"],  \"compatibility_suites\": [\"device-tests\"],  \"auto_test_config\": [],  \"module_name\": [\"hello_world_test\"],  \"test_config\": [\"out/soong/.intermediates/platform_testing/tests/example/native/hello_world_test/linux_glibc_x86_64/hello_world_test.config\"] },\n\nThe \"auto_test_config\": [] is not set, but actually, it\u0027s auto_generate but by soong.\nThat\u0027s why we think we should keep this block to reflect the real case.",
      "parentUuid": "57f5e3e8_a48a7286",
      "revId": "8c56787d923f07983b0a6de099084b455a60c642",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "77aae16f_bbc52e8d",
        "filename": "core/base_rules.mk",
        "patchSetId": 10
      },
      "lineNbr": 653,
      "author": {
        "id": 1083173
      },
      "writtenOn": "2018-08-22T03:07:22Z",
      "side": 1,
      "message": "Hmm yeah that does make sense.\n\nThe alternative is we update all our python auto_gen checks to see if they are prefixed with $SOONG_OUT_DIR (not sure if that\u0027s exported by the build system though).",
      "parentUuid": "59558ac5_bb9a86ea",
      "revId": "8c56787d923f07983b0a6de099084b455a60c642",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ff869c8c_aa14bb38",
        "filename": "core/base_rules.mk",
        "patchSetId": 10
      },
      "lineNbr": 653,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2018-08-22T03:12:27Z",
      "side": 1,
      "message": "I think there are two bugs here.  One is that Soong is not passing information to Make on whether or not the test is autogenerated.  I think that should be an explicit flag from Soong, not guessed from $(SOONG_OUT_DIR).\n\nI think there is another bug here where atest is assuming that it should build MODULES-IN-$(dirname ${test_config}).  It should be building MODULES-IN-$(dirname ${path}).  If we set LOCAL_TEST_CONFIG :\u003d subdir/testconfig.xml, it looks like it would try to build MODULES-IN-...subdir instead of MODULES-IN-...",
      "parentUuid": "77aae16f_bbc52e8d",
      "revId": "8c56787d923f07983b0a6de099084b455a60c642",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ec521531_c3cd08e7",
        "filename": "core/base_rules.mk",
        "patchSetId": 10
      },
      "lineNbr": 653,
      "author": {
        "id": 1307893
      },
      "writtenOn": "2018-08-22T03:26:44Z",
      "side": 1,
      "message": "For the 2nd but, it can handled by atest.\nAnd atest won\u0027t add it to build target when auto-gen \u003d true.",
      "parentUuid": "ff869c8c_aa14bb38",
      "revId": "8c56787d923f07983b0a6de099084b455a60c642",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "874f6acb_afa4af65",
        "filename": "core/base_rules.mk",
        "patchSetId": 10
      },
      "lineNbr": 653,
      "author": {
        "id": 1308044
      },
      "writtenOn": "2018-08-22T03:46:37Z",
      "side": 1,
      "message": "+1 for these 2 point of view.\nBut from ATest due to it\u0027s support finding test by user input the source code location.\nIt will use the TestConfig\u0027s location or auto_gen_flag to judge if the module is testable or not.\nI will try to clean up this part. change MODULES-IN-$(dirname ${path}). But the auto_test_config flag information will still be essential for atest.",
      "parentUuid": "ff869c8c_aa14bb38",
      "revId": "8c56787d923f07983b0a6de099084b455a60c642",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ee97a9f7_90d9f9a2",
        "filename": "core/base_rules.mk",
        "patchSetId": 10
      },
      "lineNbr": 654,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2018-08-21T14:47:24Z",
      "side": 1,
      "message": "ifneq (,$(filter $(SOONG_OUT_DIR)%,$(LOCAL_FULL_TEST_CONFIG))",
      "revId": "8c56787d923f07983b0a6de099084b455a60c642",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c5d9a3cd_c3972029",
        "filename": "core/base_rules.mk",
        "patchSetId": 10
      },
      "lineNbr": 654,
      "author": {
        "id": 1307893
      },
      "writtenOn": "2018-08-22T09:56:26Z",
      "side": 1,
      "message": "Done, thanks.",
      "parentUuid": "ee97a9f7_90d9f9a2",
      "revId": "8c56787d923f07983b0a6de099084b455a60c642",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "42569519_74313152",
        "filename": "core/tasks/module-info.mk",
        "patchSetId": 10
      },
      "lineNbr": 17,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2018-08-21T14:47:24Z",
      "side": 1,
      "message": "This is going to put an empty test_config for all non-tests, would it be better to wrap this in an ifdef ALL_MODULES.$(m).TEST_CONFIG",
      "revId": "8c56787d923f07983b0a6de099084b455a60c642",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b6dbf22d_4f047f58",
        "filename": "core/tasks/module-info.mk",
        "patchSetId": 10
      },
      "lineNbr": 17,
      "author": {
        "id": 1083173
      },
      "writtenOn": "2018-08-22T02:33:04Z",
      "side": 1,
      "message": "Nelson in case you\u0027re confused here Colin means this will be: \"test_config\": [\"\"] instead of \"test_config\": []",
      "parentUuid": "42569519_74313152",
      "revId": "8c56787d923f07983b0a6de099084b455a60c642",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "09be71c7_d4c8fa87",
        "filename": "core/tasks/module-info.mk",
        "patchSetId": 10
      },
      "lineNbr": 17,
      "author": {
        "id": 1307893
      },
      "writtenOn": "2018-08-22T09:56:26Z",
      "side": 1,
      "message": "Done, thanks.",
      "parentUuid": "b6dbf22d_4f047f58",
      "revId": "8c56787d923f07983b0a6de099084b455a60c642",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}