{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "a4862544_9f1ac11c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 15
      },
      "lineNbr": 0,
      "author": {
        "id": 1076194
      },
      "writtenOn": "2024-04-02T13:30:50Z",
      "side": 1,
      "message": "This is overall looking quite good and almost ready. I see Hadrien is advocating for splitting in two. In my opinion, I think it is better to just push forward with this CL and try to land it, because it\u0027ll cost you more time to split it then it\u0027d save, and this CL is looking quite good by now with few remaining issues that need to be fixed.\n\nThis leaves you with a choice:\n- If you agree with Hadrien that it should be split, go ahead and do it. You don\u0027t need my permission for this.\n- If you agree with me that we should push forward with the CL, double check with Hadrien that he\u0027s OK with it, and then fix the couple nits, and let\u0027s land it.",
      "revId": "1888b2ffe3ae4ef93e392836b55afd7f99562ccb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3c39b997_aad7a450",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 15
      },
      "lineNbr": 0,
      "author": {
        "id": 1480888
      },
      "writtenOn": "2024-04-02T17:53:43Z",
      "side": 1,
      "message": "I don\u0027t feel strongly about it. I suggested this before the CL was uploaded but it may be a bit late now.\n\nI personally don\u0027t like checking in a CL knowing it\u0027s got nits but it\u0027s @lucafarsi@google.com\u0027s call.",
      "parentUuid": "a4862544_9f1ac11c",
      "revId": "1888b2ffe3ae4ef93e392836b55afd7f99562ccb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9f1543b3_462f60f6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 15
      },
      "lineNbr": 0,
      "author": {
        "id": 1900272
      },
      "writtenOn": "2024-04-02T19:22:24Z",
      "side": 1,
      "message": "Acknowledged",
      "parentUuid": "3c39b997_aad7a450",
      "revId": "1888b2ffe3ae4ef93e392836b55afd7f99562ccb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "745a868e_fa4efb9e",
        "filename": "ci/build_test_suites.py",
        "patchSetId": 15
      },
      "lineNbr": 60,
      "author": {
        "id": 1076194
      },
      "writtenOn": "2024-04-02T13:30:50Z",
      "side": 1,
      "message": "Use a format string.\n```suggestion\n      raise RuntimeError(f\u0027Required env var {env_var} not found! Aborting.\u0027)\n```",
      "revId": "1888b2ffe3ae4ef93e392836b55afd7f99562ccb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "29f3d83c_e64e390c",
        "filename": "ci/build_test_suites.py",
        "patchSetId": 15
      },
      "lineNbr": 60,
      "author": {
        "id": 1900272
      },
      "writtenOn": "2024-04-02T19:15:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "745a868e_fa4efb9e",
      "revId": "1888b2ffe3ae4ef93e392836b55afd7f99562ccb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3d1144de_eb283930",
        "filename": "ci/build_test_suites.py",
        "patchSetId": 15
      },
      "lineNbr": 121,
      "author": {
        "id": 1076194
      },
      "writtenOn": "2024-04-02T00:22:04Z",
      "side": 1,
      "message": "You can only print this if print_cmd argument is set. That\u0027ll allow you to reuse.",
      "revId": "1888b2ffe3ae4ef93e392836b55afd7f99562ccb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fcb10fe7_6164054c",
        "filename": "ci/build_test_suites.py",
        "patchSetId": 15
      },
      "lineNbr": 121,
      "author": {
        "id": 1900272
      },
      "writtenOn": "2024-04-02T19:15:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3d1144de_eb283930",
      "revId": "1888b2ffe3ae4ef93e392836b55afd7f99562ccb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "470f4577_dee2173e",
        "filename": "ci/build_test_suites.py",
        "patchSetId": 15
      },
      "lineNbr": 124,
      "author": {
        "id": 1076194
      },
      "writtenOn": "2024-04-02T00:22:04Z",
      "side": 1,
      "message": "Don\u0027t need env\u003d.",
      "revId": "1888b2ffe3ae4ef93e392836b55afd7f99562ccb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9b2f7d34_a368749e",
        "filename": "ci/build_test_suites.py",
        "patchSetId": 15
      },
      "lineNbr": 124,
      "author": {
        "id": 1900272
      },
      "writtenOn": "2024-04-02T00:36:57Z",
      "side": 1,
      "message": "subprocess.run defaults to env\u003dNone though.",
      "parentUuid": "470f4577_dee2173e",
      "revId": "1888b2ffe3ae4ef93e392836b55afd7f99562ccb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3a4263c3_29005796",
        "filename": "ci/build_test_suites.py",
        "patchSetId": 15
      },
      "lineNbr": 124,
      "author": {
        "id": 1076194
      },
      "writtenOn": "2024-04-02T01:26:28Z",
      "side": 1,
      "message": "\"If env is not None, it must be a mapping that defines the environment variables for the new process; these are used instead of the default behavior of inheriting the current processâ€™ environment. \" In other words, when env is None it inherits the current process\u0027 environment.",
      "parentUuid": "9b2f7d34_a368749e",
      "revId": "1888b2ffe3ae4ef93e392836b55afd7f99562ccb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fa72a808_f61bfe9d",
        "filename": "ci/build_test_suites.py",
        "patchSetId": 15
      },
      "lineNbr": 124,
      "author": {
        "id": 1480888
      },
      "writtenOn": "2024-04-02T05:10:12Z",
      "side": 1,
      "message": "David is right. The initial intent was to thread `env` for unit testing purposes but it\u0027s quite useless now since there\u0027s no way to pass in the injected env.\n\nThis is why I always suggest adding tests first as it otherwise gets harder with time.",
      "parentUuid": "3a4263c3_29005796",
      "revId": "1888b2ffe3ae4ef93e392836b55afd7f99562ccb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "123ed40b_4b44068e",
        "filename": "ci/build_test_suites.py",
        "patchSetId": 15
      },
      "lineNbr": 124,
      "author": {
        "id": 1076194
      },
      "writtenOn": "2024-04-02T13:30:50Z",
      "side": 1,
      "message": "Got it. OK, if it\u0027s for unit tests, we can leave it in there, but we should add documentation to the arg explaining that it\u0027s for unit tests\n\nIt should be noted that passing os.environ through is not really necessary as Python provides extensive mocking facilities that remove the need for the code to be so aware of unit tests. But it doesn\u0027t hurt to make the test friendlier to unit tests, either -- it\u0027s more of a subjective stylistic choice.",
      "parentUuid": "fa72a808_f61bfe9d",
      "revId": "1888b2ffe3ae4ef93e392836b55afd7f99562ccb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5b87993b_246d8f23",
        "filename": "ci/build_test_suites.py",
        "patchSetId": 15
      },
      "lineNbr": 124,
      "author": {
        "id": 1900272
      },
      "writtenOn": "2024-04-02T19:15:36Z",
      "side": 1,
      "message": "Let\u0027s keep it out for now, when we add tests we can add it in if it becomes necessary.",
      "parentUuid": "123ed40b_4b44068e",
      "revId": "1888b2ffe3ae4ef93e392836b55afd7f99562ccb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "610ee1a4_2db8def0",
        "filename": "ci/build_test_suites.py",
        "patchSetId": 15
      },
      "lineNbr": 128,
      "author": {
        "id": 1076194
      },
      "writtenOn": "2024-04-02T00:22:04Z",
      "side": 1,
      "message": "We need sys.exit here instead so that users don\u0027t get a big stack trace. Something like this.\n```suggestion\n    sys.exit(\u0027Build command failed! Please see the build log for errors.\u0027)\n```",
      "revId": "1888b2ffe3ae4ef93e392836b55afd7f99562ccb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "19d6a346_1e5ea691",
        "filename": "ci/build_test_suites.py",
        "patchSetId": 15
      },
      "lineNbr": 128,
      "author": {
        "id": 1480888
      },
      "writtenOn": "2024-04-02T05:10:12Z",
      "side": 1,
      "message": "Seeing that we\u0027re going to unit test this, I\u0027d avoid sys.exiting from \u0027library\u0027 code. I suggest raising a `BuildError(exit_code)` exception that we catch in `main` and use to return the exit code:\n\n```\nif __name__ \u003d\u003d \"__main__\":\n  sys.exit(main())\n```\n\nSee Guido\u0027s original article:\n\nhttps://www.artima.com/weblogs/viewpost.jsp?thread\u003d4829\n\nBut again, here, we don\u0027t need this code in the first phase and we can simplify to accelerate this review.",
      "parentUuid": "610ee1a4_2db8def0",
      "revId": "1888b2ffe3ae4ef93e392836b55afd7f99562ccb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d7c53be1_96d8fc3e",
        "filename": "ci/build_test_suites.py",
        "patchSetId": 15
      },
      "lineNbr": 128,
      "author": {
        "id": 1076194
      },
      "writtenOn": "2024-04-02T13:30:50Z",
      "side": 1,
      "message": "Yes that sounds good.\n\nHonestly, I don\u0027t think simplifying the code will accelerate the review at this point. We might as well push forward and try to get it all in as splitting the CL in two will cost Luca more time than it will save. But I\u0027ll let Luca decide on that.",
      "parentUuid": "19d6a346_1e5ea691",
      "revId": "1888b2ffe3ae4ef93e392836b55afd7f99562ccb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f8734d3b_55e752f6",
        "filename": "ci/build_test_suites.py",
        "patchSetId": 15
      },
      "lineNbr": 128,
      "author": {
        "id": 1900272
      },
      "writtenOn": "2024-04-02T19:15:36Z",
      "side": 1,
      "message": "We don\u0027t have a `if __name__ \u003d\u003d \"__main__\":` quite like a normal function since the wrapper script is calling our main directly but I\u0027ve made it as close as possible.",
      "parentUuid": "d7c53be1_96d8fc3e",
      "revId": "1888b2ffe3ae4ef93e392836b55afd7f99562ccb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}