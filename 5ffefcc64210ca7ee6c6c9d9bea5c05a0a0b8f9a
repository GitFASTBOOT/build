{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "f2acc4fb_0332de10",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1246512
      },
      "writtenOn": "2024-04-12T08:01:42Z",
      "side": 1,
      "message": "Is there something that should be adjusted in this patch or the current patch looks ok?\n\nAnother approval needed in order to merge.\n\nThanks.",
      "revId": "5ffefcc64210ca7ee6c6c9d9bea5c05a0a0b8f9a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bb7e48a2_03ca5285",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2024-04-12T08:27:15Z",
      "side": 1,
      "message": "No other approval is required.\n\nJust need to rerun TreeHugger.",
      "parentUuid": "f2acc4fb_0332de10",
      "revId": "5ffefcc64210ca7ee6c6c9d9bea5c05a0a0b8f9a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3973be5a_926bbcf8",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1246512
      },
      "writtenOn": "2024-04-12T08:34:15Z",
      "side": 1,
      "message": "To our understanding two +2s are needed to merge patches from external contributors (non-googlers).\n\nReference:\nhttps://www.androidpolice.com/google-aosp-external-code-contributions-security-approval/",
      "parentUuid": "bb7e48a2_03ca5285",
      "revId": "5ffefcc64210ca7ee6c6c9d9bea5c05a0a0b8f9a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "626dc0b9_e050eb2b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2024-04-12T08:37:30Z",
      "side": 1,
      "message": "Oh, I see, I forgot about that.\n\nLet\u0027s see if other reviewers would like to +2.\nI still vote for using sorted(partitions) in BuildVBMeta(), as it looks cleaner to me.",
      "parentUuid": "3973be5a_926bbcf8",
      "revId": "5ffefcc64210ca7ee6c6c9d9bea5c05a0a0b8f9a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e7144016_1e907943",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 3381359
      },
      "writtenOn": "2024-04-12T10:18:50Z",
      "side": 1,
      "message": "Even though we found deterministic issue with VBmeta.. `partitions` is used not just in BuildVBMeta, it is used in several places, such care_map.pb generation\n\nCurrently the partitions dictionary is built in specific order, such as adding vbmeta_system and vbmeta_vendor at the end of the dictionary before creating the vbmeta image.\n\nNot sure if the partitions order is strict or can it be sorted order ?",
      "parentUuid": "626dc0b9_e050eb2b",
      "revId": "5ffefcc64210ca7ee6c6c9d9bea5c05a0a0b8f9a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bc9d260d_d581eb96",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2024-04-12T11:08:21Z",
      "side": 1,
      "message": "I see.\n\nBtw, I didn\u0027t mean sort the `partitions` in place.\n\nInstead, only using sorted() function when building vbmeta images.\n\nhttps://cs.android.com/android/platform/superproject/main/+/main:build/make/tools/releasetools/common.py;l\u003d1527;drc\u003d4dc089971bb1a2257cf1cc8c80e2b97b7be44086\n\n\n  \u003d\u003d\u003e for partition, path in sorted(partitions.items()):\n\nWill that still be a concern?",
      "parentUuid": "e7144016_1e907943",
      "revId": "5ffefcc64210ca7ee6c6c9d9bea5c05a0a0b8f9a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c9fae538_1ee6b47c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 3381359
      },
      "writtenOn": "2024-04-12T11:37:32Z",
      "side": 1,
      "message": "\u003e for partition, path in sorted(partitions.items()):\n\nIf the partitions order is not strict, I think it might work for vbmeta deterministic \n\nBut my point was the `partitions` will still be in deterministic dictionary and was using in other places. Just wondering if it will cause any other issues later.",
      "parentUuid": "bc9d260d_d581eb96",
      "revId": "5ffefcc64210ca7ee6c6c9d9bea5c05a0a0b8f9a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6a8afce3_b456885a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2024-04-12T12:07:58Z",
      "side": 1,
      "message": "\u003e  Just wondering if it will cause any other issues later.\n\nOK, I see, got your point.\n\nBtw, this change https://android-review.googlesource.com/c/platform/build/+/2585397 is merged ~1 year. Seems no serious issue, except that the order of AVB descriptors in vbmeta become indeterministic.\n\nSo it probably didn\u0027t cause issues other than the order in vbmeta.",
      "parentUuid": "c9fae538_1ee6b47c",
      "revId": "5ffefcc64210ca7ee6c6c9d9bea5c05a0a0b8f9a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "cfcf1984_694a4d96",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2024-04-12T13:04:42Z",
      "side": 1,
      "message": "It\u0027s good to keep the order of partitions to be deterministic, lgtm.",
      "revId": "5ffefcc64210ca7ee6c6c9d9bea5c05a0a0b8f9a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b958d1dc_819b6030",
        "filename": "tools/releasetools/add_img_to_target_files.py",
        "patchSetId": 3
      },
      "lineNbr": 1067,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2024-04-12T12:07:58Z",
      "side": 1,
      "message": "Just to confirm, why `add_partition` by ThreadPoolExecutor at line 1073 could guarantee the order? Shouldn\u0027t those calls are in parellell and is also indeterministic?",
      "range": {
        "startLine": 1067,
        "startChar": 26,
        "endLine": 1067,
        "endChar": 70
      },
      "revId": "5ffefcc64210ca7ee6c6c9d9bea5c05a0a0b8f9a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7c60bf52_5fd67b7d",
        "filename": "tools/releasetools/add_img_to_target_files.py",
        "patchSetId": 3
      },
      "lineNbr": 1067,
      "author": {
        "id": 3381359
      },
      "writtenOn": "2024-04-12T12:30:19Z",
      "side": 1,
      "message": "These partitions can be generated independently, may be the reason for introducing parallelization.\n\nWith this patch, Since the `partitions` dict already having the entry of the partitions, this `add_partition` will only update the values in the dictionary. That\u0027s why the dictionary is deterministic even though the image creations happened parallel.",
      "parentUuid": "b958d1dc_819b6030",
      "range": {
        "startLine": 1067,
        "startChar": 26,
        "endLine": 1067,
        "endChar": 70
      },
      "revId": "5ffefcc64210ca7ee6c6c9d9bea5c05a0a0b8f9a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d65af53e_29a66775",
        "filename": "tools/releasetools/add_img_to_target_files.py",
        "patchSetId": 3
      },
      "lineNbr": 1067,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2024-04-12T13:04:42Z",
      "side": 1,
      "message": "I see, got it!\n\nThanks for the explanation.",
      "parentUuid": "7c60bf52_5fd67b7d",
      "range": {
        "startLine": 1067,
        "startChar": 26,
        "endLine": 1067,
        "endChar": 70
      },
      "revId": "5ffefcc64210ca7ee6c6c9d9bea5c05a0a0b8f9a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}