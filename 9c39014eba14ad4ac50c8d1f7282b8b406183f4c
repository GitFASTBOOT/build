{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "605cca95_92a02c6a",
        "filename": "target/product/gsi/Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 3,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2023-10-05T04:04:52Z",
      "side": 1,
      "message": "When can it be a non-number?",
      "range": {
        "startLine": 3,
        "startChar": 55,
        "endLine": 3,
        "endChar": 66
      },
      "revId": "9c39014eba14ad4ac50c8d1f7282b8b406183f4c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "721b6353_541ed00a",
        "filename": "target/product/gsi/Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 3,
      "author": {
        "id": 1146974
      },
      "writtenOn": "2023-10-05T04:22:45Z",
      "side": 1,
      "message": "In the trunk_staging build, it is `VanillaIceCream`.\nSo this is not to move the VNDK apex to the vendor partition for the trunk_staging build.",
      "parentUuid": "605cca95_92a02c6a",
      "range": {
        "startLine": 3,
        "startChar": 55,
        "endLine": 3,
        "endChar": 66
      },
      "revId": "9c39014eba14ad4ac50c8d1f7282b8b406183f4c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a91a3435_3c5ea838",
        "filename": "target/product/gsi/Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 3,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2023-10-05T04:31:44Z",
      "side": 1,
      "message": "Ok for the first sentence.\n\nBut why we don\u0027t want to move it for trunk-staging?",
      "parentUuid": "721b6353_541ed00a",
      "range": {
        "startLine": 3,
        "startChar": 55,
        "endLine": 3,
        "endChar": 66
      },
      "revId": "9c39014eba14ad4ac50c8d1f7282b8b406183f4c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8bb55d36_ac1ab96e",
        "filename": "target/product/gsi/Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 3,
      "author": {
        "id": 1146974
      },
      "writtenOn": "2023-10-05T06:27:28Z",
      "side": 1,
      "message": "trunk-staging build is running tests for GSI that does not have vendor partition. We may not move the VNDK to vendor in this case for now. This is acceptable because we will deprecate the VNDK in V and we no longer need the VNDK apex soon.",
      "parentUuid": "a91a3435_3c5ea838",
      "range": {
        "startLine": 3,
        "startChar": 55,
        "endLine": 3,
        "endChar": 66
      },
      "revId": "9c39014eba14ad4ac50c8d1f7282b8b406183f4c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "46fc1511_d7e538e9",
        "filename": "target/product/gsi/Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 3,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2023-10-05T06:42:07Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "8bb55d36_ac1ab96e",
      "range": {
        "startLine": 3,
        "startChar": 55,
        "endLine": 3,
        "endChar": 66
      },
      "revId": "9c39014eba14ad4ac50c8d1f7282b8b406183f4c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4e65e210_ccba7c3c",
        "filename": "target/product/gsi/Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 5,
      "author": {
        "id": 1337669
      },
      "writtenOn": "2023-10-05T06:45:53Z",
      "side": 1,
      "message": "is testing `PLATFORM_VERSION_CODENAME \u003d\u003d REL` the same as testing `PLATFORM_VNDK_VERSION is number` here? can they be dedup-ed ?",
      "revId": "9c39014eba14ad4ac50c8d1f7282b8b406183f4c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d0d6e47a_fce8dc58",
        "filename": "target/product/gsi/Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 5,
      "author": {
        "id": 1146974
      },
      "writtenOn": "2023-10-05T07:17:35Z",
      "side": 1,
      "message": "Yes, they are the same. Do you mean to replace the `PLATFORM_VNDK_VERSION is number` check with `PLATFORM_VERSION_CODENAME \u003d\u003d REL`?\nI used the former to pair with `math_gt`, but I also like to use the latter to show the meaning more clearly.",
      "parentUuid": "4e65e210_ccba7c3c",
      "revId": "9c39014eba14ad4ac50c8d1f7282b8b406183f4c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "581ea41e_bb276d18",
        "filename": "target/product/gsi/Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 5,
      "author": {
        "id": 1337669
      },
      "writtenOn": "2023-10-05T08:01:10Z",
      "side": 1,
      "message": "I see. I\u0027m thinking something like to dedup it to\n\n```\nLATEST_VNDK_LIB_LIST :\u003d $(LOCAL_PATH)/current.txt\nUNFROZEN_VNDK :\u003d\n\nif PLATFORM_VNDK_VERSION is number\n  if PLATFORM_VNDK_VERSION \u003c\u003d 34\n    LATEST_VNDK_LIB_LIST :\u003d $(LOCAL_PATH)/$(PLATFORM_VNDK_VERSION).txt\n  else\n    UNFROZEN_VNDK :\u003d true\n  endif # PLATFORM_VNDK_VERSION \u003c\u003d 34\nendif # PLATFORM_VNDK_VERSION is number\n```\n\nso it\u0027s clear that `UNFROZEN_VNDK` and `$(PLATFORM_VNDK_VERSION).txt` are exclusive.",
      "parentUuid": "d0d6e47a_fce8dc58",
      "revId": "9c39014eba14ad4ac50c8d1f7282b8b406183f4c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "07b07db6_f9e7dd9c",
        "filename": "target/product/gsi/Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 5,
      "author": {
        "id": 1146974
      },
      "writtenOn": "2023-10-05T08:11:24Z",
      "side": 1,
      "message": "It looks better. Let me update with it. Thanks!",
      "parentUuid": "581ea41e_bb276d18",
      "revId": "9c39014eba14ad4ac50c8d1f7282b8b406183f4c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "450b32af_cd62bb9a",
        "filename": "target/product/gsi/Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 5,
      "author": {
        "id": 1146974
      },
      "writtenOn": "2023-10-05T08:55:19Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "07b07db6_f9e7dd9c",
      "revId": "9c39014eba14ad4ac50c8d1f7282b8b406183f4c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0f057806_0bb8cd54",
        "filename": "target/product/gsi/Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 27,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2023-10-05T04:04:52Z",
      "side": 1,
      "message": "I don\u0027 think there\u0027s a behavioral change here. Am I correct?",
      "range": {
        "startLine": 19,
        "startChar": 0,
        "endLine": 27,
        "endChar": 0
      },
      "revId": "9c39014eba14ad4ac50c8d1f7282b8b406183f4c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d6f3da6f_c913140e",
        "filename": "target/product/gsi/Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 27,
      "author": {
        "id": 1146974
      },
      "writtenOn": "2023-10-05T04:22:45Z",
      "side": 1,
      "message": "Yes, you are right. I just cleared the duplicated lines.\nFor the trunk_staging build, `UNFROZEN_VNDK` is not set but `PLATFORM_VERSION_CODENAME` is not `REL`.",
      "parentUuid": "0f057806_0bb8cd54",
      "range": {
        "startLine": 19,
        "startChar": 0,
        "endLine": 27,
        "endChar": 0
      },
      "revId": "9c39014eba14ad4ac50c8d1f7282b8b406183f4c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7c78829a_2d94e853",
        "filename": "target/product/gsi/Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 27,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2023-10-05T04:31:44Z",
      "side": 1,
      "message": "Acknowledged",
      "parentUuid": "d6f3da6f_c913140e",
      "range": {
        "startLine": 19,
        "startChar": 0,
        "endLine": 27,
        "endChar": 0
      },
      "revId": "9c39014eba14ad4ac50c8d1f7282b8b406183f4c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "998f1a34_980d9935",
        "filename": "target/product/gsi/Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 27,
      "author": {
        "id": 1337669
      },
      "writtenOn": "2023-10-05T06:43:51Z",
      "side": 1,
      "message": "while you are at it could you also indent the if-else blocks so it\u0027s more readable \u003d)",
      "parentUuid": "7c78829a_2d94e853",
      "range": {
        "startLine": 19,
        "startChar": 0,
        "endLine": 27,
        "endChar": 0
      },
      "revId": "9c39014eba14ad4ac50c8d1f7282b8b406183f4c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "90ba3400_8b8451be",
        "filename": "target/product/gsi/Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 199,
      "author": {
        "id": 1337669
      },
      "writtenOn": "2023-10-05T06:43:51Z",
      "side": 1,
      "message": "If product partition modules uses the same VNDK API level, they would link to this VNDK during runtime too, right?",
      "revId": "9c39014eba14ad4ac50c8d1f7282b8b406183f4c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "87e4314e_5fa33770",
        "filename": "target/product/gsi/Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 199,
      "author": {
        "id": 1146974
      },
      "writtenOn": "2023-10-05T07:17:35Z",
      "side": 1,
      "message": "Correct.",
      "parentUuid": "90ba3400_8b8451be",
      "revId": "9c39014eba14ad4ac50c8d1f7282b8b406183f4c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7d16fbc6_fce97b20",
        "filename": "target/product/gsi/Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 199,
      "author": {
        "id": 1337669
      },
      "writtenOn": "2023-10-05T08:01:10Z",
      "side": 1,
      "message": "I think for GSI targets we still want to install the \"normal\" vndk apex.\n\nOtherwise v35 GSI would not boot on v34 vendor. (GSI product modules want v35 VNDK, but GSI doesn\u0027t contain v35 VNDK)",
      "parentUuid": "87e4314e_5fa33770",
      "revId": "9c39014eba14ad4ac50c8d1f7282b8b406183f4c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0c318aaa_6b319370",
        "filename": "target/product/gsi/Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 199,
      "author": {
        "id": 1146974
      },
      "writtenOn": "2023-10-05T08:11:24Z",
      "side": 1,
      "message": "Yes, that\u0027s still a problem. We will deprecate the VNDK in V. So the problem will be gone in trunk_staging (that will be in V). But the GSI from the -next build can be used only with the vendor from -next version. This vendor image can also work with GSI from UDC.\n\nIf we do have to build the GSI with the -next build, the only solution is to deprecate the VNDK for the product partition in the -next build. But I don\u0027t think we need it, do we?",
      "parentUuid": "7d16fbc6_fce97b20",
      "revId": "9c39014eba14ad4ac50c8d1f7282b8b406183f4c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "235c7bee_66153cf5",
        "filename": "target/product/gsi/Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 199,
      "author": {
        "id": 1337669
      },
      "writtenOn": "2023-10-05T08:52:16Z",
      "side": 1,
      "message": "\u003e If we do have to build the GSI with the -next build, the only solution is to deprecate the VNDK for the product partition in the -next build.\n\nI think if we could install v35 VNDK in GSI, then we don\u0027t _need_ to deprecate product partition VNDK. Though I do agree deprecating it altogether would be a lot less messy.\n\nIf v35 GSI + v35 vendor, then we assume/require they are from the same build, so apexd could just choose to use the on_vendor one unconditionally.\nIf v35 GSI + v34 vendor, then apexd would enable both v35 for product modules and v34 for vendor modules.\n\n\u003e But I don\u0027t think we need it, do we?\n\nI\u0027m not sure... need to check with SzuWei and probably the platform release team.\nvN GSI + v(N-1) vendor is something we always support in the past. We _can_ treat U -next special and just don\u0027t support all kinds of cross-version mixing with U -next GSI at all. But that would be a conscious change and we need to modify existing processes and inform stakeholders for this special case.\n\n* One use case is our CI mixed-testing, which ties to how we manage the GSI branches. I still don\u0027t know if we would have multiple android14-qpr-gsi branches, or just one android14-gsi branch for all the qprs (latter is how we handled it in Android 13)\n* Another use case if for Android beta release. Platform release team releases Android beta images for Pixel and GSI. The Android beta GSI \"works\" because we support the N + (N-1) combo.\n\n@szuweilin@google.com",
      "parentUuid": "0c318aaa_6b319370",
      "revId": "9c39014eba14ad4ac50c8d1f7282b8b406183f4c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "600ad6d7_bcd1432e",
        "filename": "target/product/gsi/Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 199,
      "author": {
        "id": 1146974
      },
      "writtenOn": "2023-10-05T09:03:36Z",
      "side": 1,
      "message": "We need VNDK v35 on vendor to make the vendor partition built from -next work without VNDK snapshot.\n\nIn case of GSI, we may choose to install the product VNDK only for GSI or manually install the required VNDK libs for the product libs (they only 10+ libs).\nLet\u0027s discuss the details in b/299867815.",
      "parentUuid": "235c7bee_66153cf5",
      "revId": "9c39014eba14ad4ac50c8d1f7282b8b406183f4c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}