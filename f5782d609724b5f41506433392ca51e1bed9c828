{
  "comments": [
    {
      "key": {
        "uuid": "761f2555_95ba24f2",
        "filename": "tools/releasetools/blockimgdiff.py",
        "patchSetId": 6
      },
      "lineNbr": 374,
      "author": {
        "id": 1073563
      },
      "writtenOn": "2015-10-21T07:34:45Z",
      "side": 0,
      "message": "stashed_blocks is used to calculate the max stash size later. I don\u0027t think it can be deducted here because they are not actually freed. The free commands are just collected but not appended to the output buffer here.",
      "revId": "f5782d609724b5f41506433392ca51e1bed9c828",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "99784a71_d9435709",
        "filename": "tools/releasetools/blockimgdiff.py",
        "patchSetId": 6
      },
      "lineNbr": 374,
      "author": {
        "id": 1056365
      },
      "writtenOn": "2015-10-21T20:18:32Z",
      "side": 0,
      "message": "I thought about this part some time ago. Although it\u0027s not writing the \"free\" commands immediately here, the effect should be negligible. Because the only command that will be emitted prior to the \"free\" would be the current command in xf (new/move/bsdiff/imgdiff/zero and etc). The \"free\" command will be written right after the current command. We are not using stashed_blocks anywhere in-between.",
      "parentUuid": "761f2555_95ba24f2",
      "revId": "f5782d609724b5f41506433392ca51e1bed9c828",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f6ea355e_812d3ace",
        "filename": "tools/releasetools/blockimgdiff.py",
        "patchSetId": 6
      },
      "lineNbr": 374,
      "author": {
        "id": 1073563
      },
      "writtenOn": "2015-10-22T01:29:27Z",
      "side": 0,
      "message": "When making a \u0027move\u0027 or a \u0027diff\u0027, stashed_blocks will be used to calculate the max_stashed_blocks like line 450. If the unfreed blocks are deducted in advance, the temp_stash_usage could be smaller than what it is supposed to be, couldn\u0027t it? My test result shows no difference of max_stashed_blocks with or without this patch. But I guess this is because the wrong temp_stash_usage does not exceed the right max_stashed_blocks.",
      "parentUuid": "99784a71_d9435709",
      "revId": "f5782d609724b5f41506433392ca51e1bed9c828",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}