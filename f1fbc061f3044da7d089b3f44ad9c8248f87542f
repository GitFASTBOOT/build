{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "f303bf5b_c6654fbc",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1644679
      },
      "writtenOn": "2023-11-07T00:46:31Z",
      "side": 1,
      "message": "It looks like this causes builds to fail with:\n```\nFAILED: \nbuild/make/core/artifact_path_requirements.mk:30: warning:  device/google/bramble/aosp_bramble.mk produces files inside build/make/target/product/generic_system.mks artifact path requirement. \nOffending entries:\nsystem/lib/hw/android.hidl.memory@1.0-impl.so\nsystem/lib64/hw/android.hidl.memory@1.0-impl.so\nIn file included from build/make/core/main.mk:1389:\nbuild/make/core/artifact_path_requirements.mk:30: error: Build failed.\n00:27:25 ckati failed with: exit status 1\n```\nhttps://android-build.corp.google.com/artifact/pending/P65081935/aosp_bramble-trunk_staging-userdebug/latest/view/logs%2Fbuild.log\n\nI\u0027m not sure why that it would be different to add these libs from PRODUCT_PACKAGES vs the versioned PRODUCT_PACKAGES..",
      "revId": "f1fbc061f3044da7d089b3f44ad9c8248f87542f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "59bc0519_3895b1e3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1146974
      },
      "writtenOn": "2023-11-10T01:06:22Z",
      "side": 1,
      "message": "The timing of adding packages does matter. You are adding vendor modules in generic_system.mk, that is not allowed.\ngeneric_system.mk must not bring any non-system modules. So that if it is used in any devices, it will modify only the system image, not the non-system images.",
      "parentUuid": "f303bf5b_c6654fbc",
      "revId": "f1fbc061f3044da7d089b3f44ad9c8248f87542f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "237cc101_62df67a9",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1644679
      },
      "writtenOn": "2023-11-10T01:18:41Z",
      "side": 1,
      "message": "This build problem was before the `generic_system.mk` changes and was added on top of this topic (aosp/2820098 is not part of this topic).\n\nAre these `system/lib/hw/android.hidl.memory@1.0-impl.so` modules from the error message actually vendor modules? That is `vendor_available: true` and I figured if it was installed in system like that then it was a system module.\n\nThis build failure went away with the change in patch set 2 here:\n```\n# TODO(b/299166571) Remove this after the artifact path requirements checker picks up\n# this library correctly with the *SHIPPING_API_LEVEL_34 variable\nPRODUCT_ARTIFACT_PATH_REQUIREMENT_ALLOWED_LIST +\u003d \\\n\t$(TARGET_COPY_OUT_SYSTEM)/lib/hw/android.hidl.memory@1.0-impl.so \\\n\t$(TARGET_COPY_OUT_SYSTEM)/lib64/hw/android.hidl.memory@1.0-impl.so \\\n```",
      "parentUuid": "59bc0519_3895b1e3",
      "revId": "f1fbc061f3044da7d089b3f44ad9c8248f87542f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}