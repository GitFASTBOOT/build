{
  "comments": [
    {
      "key": {
        "uuid": "d3bb7530_b934f25b",
        "filename": "core/dex_preopt_config.mk",
        "patchSetId": 1
      },
      "lineNbr": 14,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2019-01-16T16:14:22Z",
      "side": 1,
      "message": "intermediates-dir-for here breaks the layering between Soong and Make.  That layering is already a little confused due to dexpreopting the boot jars in Make, but I\u0027d like to not make it worse.  I\u0027d suggest copying the boot jars into $(PRODUCT_OUT)/dex_bootjars_input or something, and using that path here.  Then when I move dexpreopting the boot jars into Soong I can remove the extra copy.",
      "revId": "f7e3c2c9d5588b1da1d2581e682a24f3b0943a95",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "38728076_275a2798",
        "filename": "core/dex_preopt_config.mk",
        "patchSetId": 1
      },
      "lineNbr": 14,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2019-01-16T16:16:34Z",
      "side": 1,
      "message": "Where should I do that copy? Here?\nhttps://cs.corp.google.com/android/build/make/core/soong_java_prebuilt.mk?l\u003d85",
      "parentUuid": "d3bb7530_b934f25b",
      "revId": "f7e3c2c9d5588b1da1d2581e682a24f3b0943a95",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d22e5cbf_9eb57651",
        "filename": "core/dex_preopt_config.mk",
        "patchSetId": 1
      },
      "lineNbr": 14,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2019-01-16T16:18:33Z",
      "side": 1,
      "message": "If you did it there you\u0027d have to do it in java.mk too to support boot jars that are not defined in Soong, although I\u0027ll have to require all boot jars in Soong once I move boot jar dexproepting there.  I\u0027d suggest doing it in dex_preopt_libart.mk or dex_preopt_libart_boot.mk",
      "parentUuid": "38728076_275a2798",
      "revId": "f7e3c2c9d5588b1da1d2581e682a24f3b0943a95",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "93683dbf_15bfc874",
        "filename": "core/dex_preopt_config.mk",
        "patchSetId": 1
      },
      "lineNbr": 14,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2019-01-16T17:59:38Z",
      "side": 1,
      "message": "I\u0027ve tried, but now I\u0027m getting:\nFAILED: ninja: \u0027out/target/product/walleye/dex_bootjars_input/android.test.base.impl.jar\u0027, needed by \u0027out/soong/.intermediates/frameworks/base/services/services/android_common/dexpreopt/profile.prof\u0027, missing and no known rule to make it\n\nLooks like soong isn\u0027t getting the build rule?",
      "parentUuid": "d22e5cbf_9eb57651",
      "revId": "f7e3c2c9d5588b1da1d2581e682a24f3b0943a95",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2a37cc97_9716f59a",
        "filename": "core/dex_preopt_config.mk",
        "patchSetId": 1
      },
      "lineNbr": 14,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2019-01-16T22:18:25Z",
      "side": 1,
      "message": "Here\u0027s what I did to get this error: I\u0027ve added this to dex_preopt_libart.mk:\n\n$(foreach mod,$(NON_UPDATABLE_BOOT_MODULES),$(eval $(call copy-one-file,$(call intermediates-dir-for,JAVA_LIBRARIES,$(mod),,COMMON)/javalib.jar),$(DEXPREOPT_BOOT_JARS_INPUT_PATH)/$(mod).jar))",
      "parentUuid": "93683dbf_15bfc874",
      "revId": "f7e3c2c9d5588b1da1d2581e682a24f3b0943a95",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9b0c8bac_4158aea4",
        "filename": "core/dex_preopt_config.mk",
        "patchSetId": 1
      },
      "lineNbr": 14,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2019-01-16T22:23:33Z",
      "side": 1,
      "message": "That should work, maybe add some $(warning) debugging to see if it\u0027s resulting in out/target/product/walleye/dex_bootjars_input/android.test.base.impl.jar?",
      "parentUuid": "2a37cc97_9716f59a",
      "revId": "f7e3c2c9d5588b1da1d2581e682a24f3b0943a95",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a6708f84_8ffdc22a",
        "filename": "core/dex_preopt_config.mk",
        "patchSetId": 1
      },
      "lineNbr": 14,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2019-01-16T22:25:54Z",
      "side": 1,
      "message": "Yeah, it is. When I had the paths wrong, the rule for boot.art complained (that rule is in makefile). Once paths were fixed, it\u0027s soong rules that complained.\n\nNote that DEXPREOPT_BOOTCLASSPATH_DEX_FILES is passed below in this file to a soong variable.",
      "parentUuid": "9b0c8bac_4158aea4",
      "revId": "f7e3c2c9d5588b1da1d2581e682a24f3b0943a95",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}